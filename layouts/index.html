{{ define "header" }}
<div class="headerContainer home textContent">
  <!-- TODO(spencer): insert kaleidescope here? -->
  <h1 id="siteTitle" title="hi! hover around other parts of the site and you might find other hidden treasures.">
    hi! i'm spencer
    {{ partial "personal_emoji.html" }}
  </h1>
  <div class="description">
    {{ $location := getJSON "https://status.spencerchang.me/api/metadata" }}
    <p><i>creative technologist, developer of poetics, dream researcher</i><br/>last in <a href="/window">{{ $location.location }}</a></p>
    
    <!-- <div >
      <img class="mainWindow" src="https://raw.githubusercontent.com/spencerc99/spencer-net-shots/main/window.png"/>
    </div> -->
    <p>
    <details>
        <summary>Dreaming, wandering, laughing, and thinking about...</summary>
        <div>
            <ul class="noPadding">
            <li>
                <b>creative agency</b> <br/> how we can give users more <a href="/posts/take-back-the-future-response">agency</a> in the software they use or are used by every day and what does a healthy relationship with <a href="/posts/technology-paradox">technology look like</a>?
            </li>
            <li>
                <b><a href="https://mmm.page/helena.soft_tech">soft tech</a></b> <br/> how do we create software that encourages tinkering and authentic expression, where making crazy connections is necessary rather than a nuisance?
            </li>
            <li>
                <b>people over systems</b> <br/> what sort of systems do we need to create a society that cares about enabling every person to live with the <a href="/experiments/100posts/privilege-of-dreams">privilege to pursue their dreams</a> and create something that they can truly own?
            </li>
            <!-- <li>
                <b>authentic <a href="/experiments/100posts/unstoppable-expression">expression</a></b> <br/> how do we create environments that provide a <a href="/experiments/100posts/low-pressure-contexts">low-pressure context</a> for people to fail and learn and scale that <a href="/experiments/100posts/trust">trust</a> beyond small local communities?
            </li> -->
            <li>
                <b>living fully</b> <br/> how do we live more fully and <a href="/experiments/100posts/intensity">intensely</a> and learn to trust ourselves to <a href="/experiments/100posts/opportunity">express ourselves</a> without caveats?
            </li>
            </ul>
        </div>
        </details>
    </p>

    <p id="expandingWork"></p>
    <!-- idk why but it's getting really broken when I inline this content when there are more than two "https://" on one line... -->
    {{ .Content }}

    <p id="expandingLikes"></p>

<script>
// TODO: can you add hover tooltips with images and previews?
// TODO: support descriptors for each in the list, and have a way to "ellipsis" to add a new of the top level one
// 'in my room', 'snuggled in quiet corners', 'in public parks'
let likes = [
  ['writing'],
  ['reading'],
  ['eating'],
  ['dressing up'],
  ['dancing'],      
  ['paying attention'],      
  ['wondering'],      
  ['wandering'],      
  ['daydreaming'],      
  ['capturing moments'],
  ['being in nature'],
  ['loving people'],
  ['sipping water'],
  ['loving life'],
  ['cracking my joints'],
  ['watermelon on a hot day'],
  ['recognizing constellations'],
  ['the city skyline at night'],
  ['uncontrollable crying'],
  ['creating magic'],
  ['experimenting'],
  ['speculative infrastructure'],
  ['computational poetry'],
  ['creative technology'],
  ['agencyful computation'],
  ['alternative futures'],
  ['playful tools'],
  ['evocative writing'],
  ['imaginative fiction'],
  ['tools for wonder'],
  ['everyday beauty'],
  ['accessible magic'],
  ['cybernetic ecology'],
  ['pluriversality'],
  ['rain drops rolling down the side of a window'],
  ["a large scarf that covers your face when it's cold outside"],
  ['warm pockets'],
  ['tender hugs'],
  ['lingering tastes'],
  ['warm lighting'],
  ['fantasizing being a blade of grass in a Hayao Miyazaki film'],
  ['stardust and shoreless seeds'],
  ['unexpected light'],
  ['unexpected mediums'],
  ['folk practices'],
  ['daily rituals'],
  ['dreaming'],
  ["art that doesn't take itself too seriously"],
  ["creating things"],
  ["making new stuff from old stuff"],
  ["laughing with friends"],
  ["sharing food"],
  ["hole-in-the-walls"],
  ["complimenting people on their outfits"],
  ["getting complimented on my outfit"],
  ["receiving a reply on my newsletter"],
  ["receiving an email from a visitor to my site"],
  ["a full water bottle"],
  ["sufficiently chapsticked lips"],
  ["worn books"],
  ["marginalia"],
  ["soulful things"],
  ["people who look at the world"],
  ["walking aimlessly"],
  ["running under 6 miles in nice weather"],
  ["taking care of things"],
  ["cultivating life"],
  ["naming"],
  ["sitting with the unknown"],
  ["laying under the stars"],
  ["watching meteor showers"],
  ["making things up and committing to the bit"],
]
const enjoyPrompt = `<a href="https://coda.io/form/spencers-enjoy-list_dGFsXoodVB1">what do you think I'll like?</a>`;
// randomize likes
likes = likes.sort(() => Math.random() - 0.5);
likes.splice(12, 0, [enjoyPrompt]);
let likeExpandedIdx = 0;

function createLikeNode(like) {
  const likeNode = document.createElement("span");
  likeNode.classList.add('likeItem')
  likeNode.innerHTML = `${like}`;
  if (likeExpandedIdx < likes.length - 1) {
    likeNode.innerHTML += ', ';
  } 
  if (likeExpandedIdx === likes.length - 2) {
    likeNode.innerHTML += 'and ';
  } 
  return likeNode;
}
const likesNode = document.createElement("div");
likesNode.id = 'telescope';
const onMoreNode = document.createElement("div");
onMoreNode.style = "display: inline-block;"
onMoreNode.setAttribute('role', 'button')
onMoreNode.setAttribute('tabindex', '0')
onMoreNode.setAttribute('title', 'click me to see more! try tabbing to me and using enter or space to go even faster!')
onMoreNode.innerHTML = 'and...';
onMoreNode.addEventListener('click', onClickMore);
onMoreNode.addEventListener('keydown', onKeyDown);
const likesContainer = document.getElementById("expandingLikes")
likesContainer.appendChild(likesNode);
likesNode.appendChild(document.createTextNode('A non-exhaustive list of the things I enjoy:'))
likesNode.appendChild(document.createElement("br"))
likesNode.appendChild(onMoreNode);
onMoreNode.classList.add("details");
onMoreNode.classList.add("close");


function onKeyDown(e) {
  if (event.key === 'Enter' || event.key === ' ') {
    onClickMore();
    e.preventDefault();
  }
}

function onClickMore() {
  const likeNode = createLikeNode(likes[likeExpandedIdx]);
  likesNode.insertBefore(likeNode, onMoreNode);
  likeExpandedIdx++;
  if (likeExpandedIdx === likes.length) {
    onMoreNode.remove();
    return;
  }
}
onClickMore();

</script>

<p>
  Support my work by buying me a coffee on <a href="https://github.com/sponsors/spencerc99">Github Sponsors</a>.
</p>
    <p>
        <details>
        <summary>some things I'm proud of...</summary>
        <div>
            <ul class="noPadding">
            <li><a href="https://coda.io/packs">Packs Ecosystem</a>: A platform and ecosystem for extending the functionality of Coda by 
            connecting to external services and taking action on data. Makes Coda better achieve a promise of interoperability and being an operating layer on top of all your existing data from anywhere.</li>
            <li><a href="https://pluriverse.world">Towards a Digital Pluriverse</a>: An interactive, participatory essay proposing the "pluriverse" as a new banner for the community to rally around for how we look at imagining a "new web." It is co-created with visitors and readers of the site.</li>
            <li><a href="https://coda.io/@steve/meet-custom-templates">Custom Templates</a>: empowered anyone to create a template on Coda, a reusable and shareable set of components, to streamline common workflows, share personal tools with their team, and adopt practices from the wider community in their own doc.</li>
            <li><a href="https://tiny-inter.net">tiny internets</a>: a research inquiry on what does a more natural, soft, and quiet internet look like, one where public spaces are actively shaped by us to not only use but live in? Explored during the Interact Residency and created browser extension explroing different avenues for intimacy with beta users, including digital geocaching, commuting, and time capsules.</li>
            <li><a href="/posts/everyday-magic">Everyday Magic</a> essay for <a href="https://reboothq.substack.com/">reboot</a> on the magic of the technology and why we need to and how we make it accessible to everyone.</li>
            <li><a href="/experiments/100posts">100 mini-essays</a>: A collection of 100 posts I've written in 2021, comprising personal essays, poems, short stories, and more.</li>
            <li>My <a href="/fits">Fits Stream</a>, an auto-stream of my daily outfits.</li>
            </ul>
        </div>
        </details>
    </p>

    <!-- TODO: make an art page -->
    <p>Open to collaborations and chatting around <a href="https://coda.io/@spencer/tiny-internets/public-presentations-39">digital media art</a>, <a href="/experiments/100posts/future-of-tools/">speculative infrastructure</a>, and alternative <a href="https://tiny-inter.net/">internets</a>.</p>

    
    <div id="signature"><div class="signatureContent">
      <!-- TODO: hover over for photo in lil modal? -->
      <div class="serif">Spencer 張正 Chang<br/>spencerc99@gmail.com</div>
      <img id="stamp" class="stamp" src="/assets/name-stamp.png" title="this is my name stamp. my chinese name is 張正, 正 being my given name. 正 has many meanings: just, right, 5 if marking tallies on a food ordering sheet, proper, main, positive (for numbers). this animation was made on winter solstice and inspired by the scene from avatar the last airbender where aang opens the door to visit avatar roku during the winter solstice."/>
      {{ partial "social_media.html" . }}
      </div>
    </div>
    {{ partial "email_embed.html" . }}
  </div>    
</div>
{{ end }} 
{{ define "main" }}
<!-- TODO: replace this with kaleidoscope or feral.earth stuff -->
<div class="summaryList expand">
  <!-- TODO: make this a tab -->
  <div class="tabs">
    <button onclick="setTab(0)"><h3>recent</h3></button>
    <button onclick="setTab(1)"><h3>creations</h3></button>
    <button onclick="setTab(2)"><h3>writing</h3></button>
  </div>
  <div class="tabContent">
    {{ $project := slice "projects" }}
    {{ $projects := where .Site.RegularPages "Params.tags" "intersect" $project }}
    {{ $writing := .Site.RegularPages | complement $projects }}
    <div class="recentReleases hidden">
      <div class="postsList">
        {{ $recentCands := .Site.RegularPages.ByDate.Reverse }}
        {{ $recentCands = where $recentCands "Draft" "==" false }}
        {{ range first 10 $recentCands  }}
          {{ .Render "compact_summary" }} 
        {{ end }}
        <!-- TODO: add "check out my feed link to feed of everything" -->
        Check out <a href="/projects">all {{ len $projects}} creations</a> or <a href="/posts">all {{ len $writing}} posts</a>.
      </div>
    </div>
    <div class="projects hidden">
        <div class="postsList">
        {{ $favorite := slice "favorite" }}
        {{ $favorites := where .Site.RegularPages "Params.tags" "intersect" $favorite }}
        {{ $faveProjects := intersect $favorites $projects }}
        {{ $intersectedProjects := intersect $favorites $projects }}
        {{ range first 7 ($faveProjects | append $intersectedProjects) }}
          {{ .Render "compact_summary" }} 
        {{ end }}
        <br/>
        Check out <a href="/projects">all {{ len $projects}} creations</a>.
      </div>
    </div>
    <div class="writing hidden">
        <div class="postsList">
        {{ $favorite := slice "favorite" }}
        {{ $favorites := (where .Site.RegularPages "Params.tags" "intersect" $favorite) | complement $projects }}
        {{ $favorites = where $favorites "Draft" "==" false }}
        {{ $intersectedWriting := $favorites}}        
        {{ range first 7 ($favorites | append $intersectedWriting)  }}
          {{ .Render "compact_summary" }} 
        {{ end }}
        <br/>
        Check out <a href="/posts">all {{ len $writing}} posts</a>.
      </div>
    </div>
  </div>
</div>

<!-- window embeds -->
<!-- TODO: need to fix scroll hijacking and the perf -->
<!-- <div class="window" style="left: 1%; top:23%;"><iframe src="https://spencerchang.me/window#sky"></iframe></div>
<div class="window" style="right: 2%; top:23%;"><iframe src="https://spencerchang.me/window#selfie"></iframe></div>
<div class="window" style="left: 2.5%; top:73%;"><iframe src="https://spencerchang.me/window#vignette"></iframe></div> -->

{{ partial "marquee.html" }}

<script>
  let summaryIdx = 0;
  const listElement = document.querySelector('.tabContent')
  const items = listElement.children;
  const tabs = document.querySelector('.tabs').children;
  const total = items.length;

  if ("ontouchstart" in document.documentElement) {
    const hammer = new Hammer(listElement, {
      recognizers: [[Hammer.Swipe, { direction: Hammer.DIRECTION_HORIZONTAL }]],
    });

    hammer.on("swipeleft", () => {
      navForward();
    });
    hammer.on("swiperight", () => {
      navBackward();
    });
  }

  const navForward = () => {
    hideEleAtIdx();
    summaryIdx = (summaryIdx + 1) % total;
    renderEleAtIdx();
  };
  const navBackward = () => {
    hideEleAtIdx();
    summaryIdx = summaryIdx === 0 ? total - 1 : (summaryIdx - 1) % total;
    renderEleAtIdx();
  };

  const hideEleAtIdx = () => {
    items[summaryIdx].classList.add('hidden');
    tabs[summaryIdx].classList.remove('active');
  }
  const renderEleAtIdx = () => {
    items[summaryIdx].classList.remove('hidden');
    tabs[summaryIdx].classList.add('active');
  }

  const setTab = (idx) => {
    hideEleAtIdx(summaryIdx);
    summaryIdx = idx;
    renderEleAtIdx(summaryIdx);
  }

  renderEleAtIdx(summaryIdx);
</script>
{{ end }}
